(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8443],{7160:(e,a,s)=>{Promise.resolve().then(s.bind(s,6541))},1556:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(7401).A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},6541:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>w});var t=s(5155),l=s(8531),i=s(9749),n=s(2115),o=s(7709),r=s(9606),c=s(1665),d=s(4460),m=s(3312),u=s(7780),x=s(5160),p=s(648),v=s(1536),f=s(5239),h=s(3391),j=s(8897),N=s.n(j),g=s(4179),b=s(8986),y=s(1589);function C(e){var a;let s,{setNetWeight:l,CompanyID:i,SectionID:o}=e,[r,c]=(0,n.useState)(!1),[u,x]=(0,n.useState)(!1),[p,{data:v}]=(0,d.G5)();(0,n.useEffect)(()=>{o>0&&i>0?x(!0):x(!1)},[o,i]);let f=async()=>{try{await p({PurposeID:1,SectionID:o,CompanyID:i})}catch(e){console.error("Error fetching weight:",e)}r?s=setTimeout(f,1e3):clearTimeout(s)};return(0,n.useEffect)(()=>(r&&f(),()=>clearTimeout(s)),[r]),(0,n.useEffect)(()=>{if(v){var e;l((null==v?void 0:null===(e=v[0])||void 0===e?void 0:e.WeightValue)||0)}},[v]),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsxs)("h3",{className:"font-medium flex items-center gap-2 border-2 rounded-md w-full px-2 py-1",children:[(0,t.jsx)(y.md8,{className:"text-primary"}),(0,t.jsxs)("span",{className:"text-lg font-semibold",children:[(null==v?void 0:null===(a=v[0])||void 0===a?void 0:a.WeightValue)||0," kg"]})]}),(0,t.jsx)(m.$,{type:"button",variant:"outline",size:"sm",className:"text-xs",disabled:!u,onClick:()=>c(!r),children:r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.wFo,{className:"text-red-500"})," ",(0,t.jsx)("span",{children:"Stop"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.gSK,{className:"text-green-500"})," ",(0,t.jsx)("span",{children:"Start"})]})})]}),(0,t.jsx)("div",{className:"flex items-center gap-2"})]})}var D=s(3900),I=s(1556),E=s(6263);function S(e){var a;let{setScanData:s}=e,[l,i]=(0,n.useState)(""),[o,r]=(0,n.useState)(!1),[c,{data:u,isLoading:x}]=(0,d.tT)();return(0,n.useEffect)(()=>{s([]),l&&11===l.length?c({Barcode:l}):s([])},[l]),(0,n.useEffect)(()=>{var e;(null==u?void 0:null===(e=u[0])||void 0===e?void 0:e.intBoxID)?s(null==u?void 0:u[0]):s([])},[u]),(0,t.jsxs)("div",{className:"flex items-center gap-2 ".concat(x?"cursor-not-allowed":""),children:[(0,t.jsxs)("div",{className:"flex items-center w-full border-2 rounded-md pr-2",children:[(0,t.jsx)(D.p,{type:"text",placeholder:"Enter or scan barcode",value:l,disabled:x,className:"pr-10 border-none focus:outline-none focus:ring-0",onChange:e=>{i(e.target.value),s([])}}),l&&11===l.length&&(0,t.jsx)(t.Fragment,{children:(null==u?void 0:null===(a=u[0])||void 0===a?void 0:a.intBoxID)?(0,t.jsx)(v.A7C,{className:"h-5 w-5 text-green-500"}):(0,t.jsx)(v._Hm,{className:"h-5 w-5 text-red-500"})})]}),(0,t.jsx)(m.$,{type:"button",variant:"outline",size:"icon",onClick:()=>{s([]),i("")},disabled:!u,children:(0,t.jsx)(I.A,{className:"h-4 w-4"})}),(0,t.jsx)(E.A,{open:o,onOpenChange:r,onScan:async e=>{s([]),i(e)}})]})}let w=(0,n.memo)(function(){var e,a,s,j,D;let[I,E]=(0,n.useState)([]),[w,_]=(0,n.useState)(""),[M,P]=(0,n.useState)(Date.now()),[O,L]=(0,n.useState)(!0),[A,B]=(0,n.useState)("1"),[R,T]=(0,n.useState)(0),[k,z]=(0,n.useState)(0),[J,F]=(0,n.useState)(),{userData:G}=(0,h.d4)(e=>e.user),[W,{data:q,isLoading:Q}]=(0,d.Le)(),{data:V,isLoading:$}=(0,d.xk)(null==G?void 0:G.GRP_EMP_NO),[Y,{data:H,isLoading:K}]=(0,d.VC)(),[Z,{data:X,isLoading:U}]=(0,d.ak)(),[ee,{data:ea,isLoading:es}]=(0,d._B)(),[et,{data:el,isLoading:ei}]=(0,d.Ly)(),[en]=(0,d.d_)(),[eo,{isLoading:er}]=(0,d.CK)(),{control:ec,setValue:ed,handleSubmit:em,formState:{errors:eu},watch:ex,reset:ep}=(0,r.mN)(),ev=(null===(e=ex("company"))||void 0===e?void 0:e.value)||"",ef=null===(a=ex("productionSection"))||void 0===a?void 0:a.value;null===(s=ex("operator"))||void 0===s||s.value;let eh=null===(j=ex("machine"))||void 0===j?void 0:j.value;null===(D=ex("toSection"))||void 0===D||D.value;let ej=ex("jobs")||[];(0,n.useEffect)(()=>{G&&W({GroupEmpID:null==G?void 0:G.GRP_EMP_NO})},[G,W]),(0,n.useEffect)(()=>{(null==q?void 0:q[0])&&ed("company",{label:q[0].Company,value:q[0].CompanyID})},[q,ed]),(0,n.useEffect)(()=>{(null==H?void 0:H[0])&&(null==V?void 0:V[0])&&(ed("toSection",{label:V[0].SECTION_NAME,value:V[0].SECTION_ID}),ed("productionSection",{label:H[0].SECTION_NAME,value:H[0].SECTION_ID}))},[H,V,ed]),(0,n.useEffect)(()=>{ev&&(Y({EmpID:null==G?void 0:G.GRP_EMP_NO}),eN("productionSection"),eN("machine"),eN("operator"),eN("toSection"),eN("jobs"))},[ev,Y]),(0,n.useEffect)(()=>{ev&&ef&&(ee({SECTION_ID:ef,CompanyID:ev,EmpID:null==G?void 0:G.GRP_EMP_NO}),Z({SectionID:ef,CompanyID:ev,EmpID:null==G?void 0:G.GRP_EMP_NO}),eN("operator"),eN("machine"),eN("jobs"))},[ev,ef,ee,Z]),(0,n.useEffect)(()=>{eh&&ef&&(et({intMCID:eh,SectionID:ef,EmpID:null==G?void 0:G.GRP_EMP_NO}),eN("jobs"))},[eh,ef,et]),(0,n.useEffect)(()=>{let e=async()=>{if(ej.length&&eh)try{let e=await Promise.all(ej.map(async e=>{let{data:a}=await en({intJobID:e.value,intMCID:eh,EmpID:null==G?void 0:G.GRP_EMP_NO});return{...null==a?void 0:a[0],parentName:e.label}}));E(e.filter(e=>e.intMCPlanID))}catch(e){console.error("Error fetching job details:",e),c.oR.error("Failed to load job details")}};E([]),e()},[JSON.stringify(ej),eh,en]),(0,n.useEffect)(()=>{I.length>0&&(null==J?void 0:J.intBoxID)?L(!1):L(!0)},[I,J]),(0,n.useEffect)(()=>{let e;return er?e=setTimeout(()=>T(e=>e+1),1e3):T(0),()=>clearTimeout(e)},[er,R]);let eN=e=>{ex(e)&&ed(e,null)},eg=(0,n.useCallback)((e,a,s)=>(null==e?void 0:e.map(e=>({label:e[a],value:e[s]})))||[],[]),eb=async e=>{if(!(await N().fire({title:"Confirm Box Assignment",icon:"warning",showCancelButton:!0,confirmButtonColor:"#008000",cancelButtonColor:"#d33",confirmButtonText:"Confirm"})).isConfirmed){N().fire({position:"center",icon:"info",title:"Assignment cancelled",showConfirmButton:!1,timer:800});return}let a=I.filter(e=>null==e?void 0:e.intMCPlanID).map(a=>({intMCID:e.machine.value,intMCPlanID:a.intMCPlanID,intOperator:e.operator.value,intBoxID:null==J?void 0:J.intBoxID,DecBoxWeight:k,sectionID:e.productionSection.value,companyID:e.company.value,toSection:e.toSection.value,EmpID:null==G?void 0:G.GRP_EMP_NO,IsDay:A}));if(0===a.length){c.oR.error("No valid job details found for assignment");return}try{await eo(a).unwrap(),ey(),N().fire({position:"center",icon:"success",title:"Box assigned successfully",showConfirmButton:!1,timer:800})}catch(e){console.error("Error submitting data:",e),c.oR.error("Failed to assign box")}finally{}},ey=()=>{ep(),P(Date.now()),E([]),_(""),F([]),T(0)};return(0,t.jsxs)("div",{className:"container md:p-6",children:[(0,t.jsxs)(i.Zp,{className:"flex items-center justify-between p-3 mb-4",children:[(0,t.jsx)(l.h,{variant:"primary",size:"sm",children:"Production Box Assign"}),(0,t.jsxs)(g.z,{value:A,onValueChange:B,className:"flex gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(g.C,{value:"1",id:"Day"}),(0,t.jsxs)(b.J,{htmlFor:"Day",className:"flex items-center gap-1 cursor-pointer",children:[(0,t.jsx)(y.wQq,{})," ",(0,t.jsx)("span",{children:"Day"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(g.C,{value:"0",id:"Night"}),(0,t.jsxs)(b.J,{htmlFor:"Night",className:"flex items-center gap-1 cursor-pointer",children:[(0,t.jsx)(y.V6H,{})," ",(0,t.jsx)("span",{children:"Night"})]})]})]})]}),(0,t.jsxs)("form",{className:"my-3 px-2 md:px-5",onSubmit:em(eb),children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-5",children:[[{label:"Company ".concat(Q?" (Loading...)":""),name:"company",options:eg(q,"Company","CompanyID")},{label:"To Section ".concat($?" (Loading...)":""),name:"toSection",options:eg(V,"SECTION_NAME","SECTION_ID"),isDisabled:!ev},{label:"Production Section ".concat(K?" (Loading...)":""),name:"productionSection",options:eg(H,"SECTION_NAME","SECTION_ID"),isDisabled:!ev},{label:"Operator ".concat(U?" (Loading...)":""),name:"operator",options:eg(X,"Name","OparatorEmpID"),isDisabled:!ef},{label:"Machine ".concat(es?" (Loading...)":""),name:"machine",options:eg(ea,"vcMCCODE","intMCID"),isDisabled:!ef},{label:"Select Jobs ".concat(ei?" (Loading...)":""),name:"jobs",options:eg(el,"vcJobNo","intJobID"),isMulti:!0,isDisabled:!eh}].map(e=>{var a,s;let{label:l,name:i,options:n,isDisabled:c,isMulti:d}=e;return(0,t.jsxs)("div",{className:"min-w-[300px]",children:[(0,t.jsx)(b.J,{children:l}),(0,t.jsx)(r.xI,{name:i,control:ec,rules:{required:"".concat(l.replace(/\(.*?\)/,"").trim()," is required")},render:e=>{let{field:a}=e;return(0,t.jsx)(o.Ay,{...a,options:n,isDisabled:c,isMulti:d,instanceId:i,isClearable:!0,className:"text-black",classNamePrefix:"select"})}}),eu[i]&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:null===(s=eu[i])||void 0===s?void 0:null===(a=s.message)||void 0===a?void 0:a.toString()})]},i)}),(0,t.jsxs)("div",{className:"min-w-[300px]",children:[(0,t.jsx)(b.J,{children:"Scan QR/Bar code"}),(0,t.jsx)(S,{setScanData:F})]}),(0,t.jsxs)("div",{className:"min-w-[300px]",children:[(0,t.jsx)(b.J,{children:"Box Weight"}),(0,t.jsx)(C,{setNetWeight:z,CompanyID:ev,SectionID:ef})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 mt-4",children:[(0,t.jsxs)(m.$,{variant:"destructive",onClick:ey,disabled:er,type:"button",children:["Clear ",(0,t.jsx)(p.Tfw,{className:"ml-2"})]}),(0,t.jsx)(m.$,{disabled:O||er,variant:"default",type:"submit",children:er?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.hW,{className:"animate-spin mr-2"}),"Saving (",R,"s)"]}):(0,t.jsxs)(t.Fragment,{children:["Save ",(0,t.jsx)(u.A,{className:"ml-2"})]})})]})]},M),(0,t.jsx)("div",{className:"space-y-4 mb-10 px-2 md:px-5",children:I.map((e,a)=>(0,t.jsxs)("div",{className:"border-2 border-primary rounded-xl p-3",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,t.jsx)(v.rrY,{className:"text-primary"}),e.parentName]}),e.decAllocQty?(0,t.jsx)(i.Zp,{className:"mt-2",children:(0,t.jsxs)(i.Wu,{className:"pt-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[(0,t.jsx)(f.L,{icon:(0,t.jsx)(p.A2r,{className:"text-blue-500",size:30}),label:"Allocated Qty",value:e.decAllocQty}),(0,t.jsx)(f.L,{icon:(0,t.jsx)(v.$BV,{className:"text-blue-500",size:30}),label:"MC Counter Rate",value:e.decMCCounterRate}),(0,t.jsx)(f.L,{icon:(0,t.jsx)(v.YYR,{className:"text-green-500",size:30}),label:"MC Output",value:e.decOutPut}),(0,t.jsx)(f.L,{icon:(0,t.jsx)(v.w_X,{className:"text-yellow-500",size:30}),label:"WPM",value:e.decWPM}),(0,t.jsx)(f.L,{icon:(0,t.jsx)(v.Ani,{className:"text-purple-500",size:30}),label:"MC Counter Count",value:e.intMCCounterCount}),(0,t.jsx)(f.L,{icon:(0,t.jsx)(v.aQJ,{className:"text-red-500",size:30}),label:"No of taps",value:e.intNoofTapes})]}),e.IDescription&&(0,t.jsxs)("div",{className:"my-2 flex items-center gap-2 border border-orange-500 rounded-xl p-2",children:[(0,t.jsx)(m.$,{variant:"ghost",size:"icon",children:(0,t.jsx)(x.A,{className:"text-orange-500",size:20})}),(0,t.jsx)("span",{className:"text-sm",children:e.IDescription})]})]})}):(0,t.jsx)("div",{className:"p-5",children:(0,t.jsx)("p",{className:"text-red-500 font-bold",children:"No job details available. Please disregard this job!"})})]},a))})]})})},8986:(e,a,s)=>{"use strict";s.d(a,{J:()=>c});var t=s(5155),l=s(2115),i=s(6195),n=s(1027),o=s(1567);let r=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(i.b,{ref:a,className:(0,o.cn)(r(),s),...l})});c.displayName=i.b.displayName},4179:(e,a,s)=>{"use strict";s.d(a,{C:()=>c,z:()=>r});var t=s(5155),l=s(2115),i=s(1470),n=s(3565),o=s(1567);let r=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(i.bL,{className:(0,o.cn)("grid gap-2",s),...l,ref:a})});r.displayName=i.bL.displayName;let c=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(i.q7,{ref:a,className:(0,o.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...l,children:(0,t.jsx)(i.C1,{className:"flex items-center justify-center",children:(0,t.jsx)(n.A,{className:"h-3.5 w-3.5 fill-primary"})})})});c.displayName=i.q7.displayName}},e=>{var a=a=>e(e.s=a);e.O(0,[5479,6711,8320,6446,7525,3391,4716,9295,1342,552,9606,7709,5232,5746,8441,1517,7358],()=>a(7160)),_N_E=e.O()}]);